{
  "application": "myapp",
  "branch": "master",
  "deploy_to": "/home/deploy/apps/foobar",
  "default_stage": "staging",
  "keep_releases": 3,
  "tasks": {
    "deploy": {
      "restart": {
        "web": "sudo service restart {{application}}",
        "workers": "rake workers:restart"
      },
      "after_pull_changes": "echo {{revision}} >> {{current_path}}/REVISION.txt"
    }
  },
  "stages": {
    "production": {
      "port": 2222,
      "roles": {
        "web": [ "production-web1", "production-web2" ],
        "workers": [ "production-workers1", "production-workers2" ]
      },
      "tasks": {
        "deploy": {
          "before_restart": {
            "web": "picky production servers that do something special"
          }
        }
      }
    },
    "staging": {
      "port": 3333,
      "roles": {
        "web": [ "staging-web1" ],
        "workers": [ "staging-workers1" ]
      }
    }
  }
}